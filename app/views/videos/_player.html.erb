<div class="flex-video">
	<div id="player">
	</div>
</div>

<script type="text/javascript">


	//var video = '<%= raw @video.ytid %>';

	var tag = document.createElement('script');
	tag.src = "https://www.youtube.com/iframe_api";
	var firstScriptTag = document.getElementsByTagName('script')[0];
	firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

	
	var player;
	var timeouts = [];
	var timer;
	var played = 0;

	function onYouTubeIframeAPIReady() {
	    initPlayer();
	}

	function onPlayerReady(event) {
	    //event.target.playVideo();
	    //event.target.loadVideoById('<%= @video.ytid %>', 60, "default");
	    //player.pauseVideo();
	    //player.setLoop(true);
	    player.addEventListener("onError", "onPlayerError");
	}

	function onPlayerStateChange(event) {

	}

	function onPlayerError() {
		alert('err');
		if(played)
			played = played - 1;
	}


	
	function initPlayer() {
		player = new YT.Player('player', {
	        height: '315',
	        width: '420',
	        videoId: '<%= @video.ytid %>',
	        events: {
	            'onReady': onPlayerReady,
	            'onStateChange': onPlayerStateChange
	        }
	    });

	}

</script>